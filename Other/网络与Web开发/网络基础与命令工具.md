# 网络基础与命令工具

## 第一部分：TCP 元组基础

### TCP 元组的定义
TCP 元组（TCP Tuple）是指用于唯一标识一个 TCP 连接的参数组合。通常由以下四个核心元素组成（称为**四元组**）：
1. **源 IP 地址**（Source IP Address）  
   - 发起连接的客户端或设备的 IP 地址。
1. **源端口号**（Source Port）  
   - 客户端随机分配或指定的端口号，用于标识本地应用程序。
1. **目的 IP 地址**（Destination IP Address）  
   - 目标服务器或服务的 IP 地址。
1. **目的端口号**（Destination Port）  
   - 目标服务监听的端口号（如 HTTP 的 80 端口、HTTPS 的 443 端口）。

### 为什么需要 TCP 元组
- **唯一性**：四元组组合能唯一标识一个 TCP 连接，即使同一客户端向同一服务器发起多个连接（通过不同源端口），也能通过元组区分。
- **路由与转发**：网络设备（如路由器、防火墙、负载均衡器）利用四元组将数据包正确分发到对应的连接。
- **状态跟踪**：操作系统和防火墙通过维护四元组信息来管理连接状态（如建立、保持、关闭）。

### 扩展：五元组
在某些场景中，还会加入 **协议类型**（如 TCP/UDP），形成五元组：
- 源 IP、源端口、目的 IP、目的端口、协议类型。  
- 用于区分不同协议（如 TCP 和 UDP）的流量。

### 应用场景
1. **负载均衡**  
   - 负载均衡器根据四元组将请求分发到不同服务器，或保持同一用户的会话一致性。
1. **防火墙规则**  
   - 防火墙通过匹配五元组（协议 + 四元组）过滤或允许特定流量。
1. **NAT（网络地址转换）**  
   - NAT 设备通过修改源 IP/端口（或目的 IP/端口）建立映射表，实现内外网地址转换。

### 示例
假设客户端（IP `192.168.1.100`，端口 `54321`）访问服务器（IP `93.184.216.34`，端口 `443`），则对应的 TCP 四元组为：  
`(192.168.1.100:54321, 93.184.216.34:443)`
## 总结与实践建议

| 命令                 | 主要用途                   | 备注              |
| :----------------- | :--------------------- | :-------------- |
| `ip`               | **查看和配置**网络接口、路由       | **新时代主力**，必学    |
| `ss` / `netstat`   | **查看网络连接**和端口监听状态      | `ss` 更快更现代      |
| `ping`             | **测试基础连通性**和延迟         | 最常用             |
| `traceroute`       | **追踪网络路径**，定位故障点       |                 |
| `dig` / `nslookup` | **DNS 查询和诊断**          | `dig` 更强大       |
| `curl` / `wget`    | **下载文件**、**测试 Web 服务** | API 调试常用 `curl` |
| `tcpdump`          | **网络抓包**，**高级故障诊断**    | 高手必备            |
| `ssh`              | **安全远程登录**服务器          | 运维基础            |